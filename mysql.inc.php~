<?php

// Этот файл включает информацию, применяемую для доступа к базе данных 
// Этот файл устанавливает подключение к MySQL и выбирает базу данных
// Этот файл определяет функцию, обеспечивающую безопаность данных, применяемых в запросах
// Этот файл определяет функцию, применяемую для хеширования паролей
// Этот сценарий начал создаваться в главе 3.

// Настройка констант, применяемых для доступа к базе данных
DEFINE ('DB_USER', 'db_adm1');
DEFINE ('DB_PASSWORD', 'ecommerce1');
DEFINE ('DB_HOST', 'localhost');
DEFINE ('DB_NAME', 'ecommerce1');

// Создание подключения
$dbc = mysqli_connect (DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);

// Настройка набора символов
mysqli_set_charset($dbc, 'utf8');

// Функция, применяемая для экранирования и уменьшения объема данных формы
// Принимает один аргумент: рассматриваемые данные (строка).
// Возвращает обработанные данные (строку)
function escape_data ($data, $dbc) { 

	// Убирает символы косой черт, если включены "волшебные" кавычки
	if (get_magic_quotes_gpc()) $data = stripslashes($data);
	
	// Применяется trim() и mysqli_real_escape_string()
	return mysqli_real_escape_string ($dbc, trim ($data));
	
} // конец фукнции escape_data()

// Пропущен закрывающий тег PHP, чтобы избежать появления ошибок 'headers are sent'!